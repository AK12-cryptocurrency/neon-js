<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>api · neon-js</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The `api` module is available as the plugin `@cityofzion/neon-api`."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="api · neon-js"/><meta property="og:type" content="website"/><meta property="og:url" content="http://cityofzion.io/neon-js/index.html"/><meta property="og:description" content="The `api` module is available as the plugin `@cityofzion/neon-api`."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/neon-js/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://unpkg.com/@cityofzion/neon-js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/neon-js/js/scrollSpy.js"></script><link rel="stylesheet" href="/neon-js/css/main.css"/><script src="/neon-js/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/neon-js/en"><img class="logo" src="/neon-js/img/logo.svg" alt="neon-js"/><h2 class="headerTitleWithLogo">neon-js</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/neon-js/docs/en/installation.html" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/neon-js/docs/en/api/index.html" target="_self">API</a></li><li class=""><a href="/neon-js/docs/en/examples/index.html" target="_self">Examples</a></li><li class=""><a href="/neon-js/docs/en/changelog/latest.html" target="_self">Changelog</a></li><li class=""><a href="/neon-js/en/help.html" target="_self">Help</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Plugin Modules</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/index.html">API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Core Modules</h3><ul class=""><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/wallet.html">Wallet</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/tx.html">Transactions</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/rpc.html">RPC</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/sc.html">Smart Contract</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/u.html">Utility</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/const.html">Constants</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/settings.html">Settings</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/core/logging.html">Logging</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Plugin Modules</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/neon-js/docs/en/api/plugin/api.html">api</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/plugin/nep5.html">NEP5</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/plugin/nep9.html">NEP9</a></li><li class="navListItem"><a class="navItem" href="/neon-js/docs/en/api/plugin/domain.html">neon-domain</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">api</h1></header><article><div><span><p>The <code>api</code> module is available as the plugin <code>@cityofzion/neon-api</code>.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> Neon, { api } <span class="hljs-keyword">from</span> <span class="hljs-string">"@cityofzion/neon-js"</span>;
Neon.sendAsset(config);
Neon.claimGas(config);
Neon.doinvoke(config);

api.neoscan.getBalance(<span class="hljs-string">"http://www.neoscan-testnet.io/test_net/v1/"</span>, address);
api.sendAsset(config);
</code></pre>
<p>The <code>api</code> module contains all 3rd party API that is useful together with Neon. A normal NEO node does not provide us with a convenient way of subscribing to smart contract events and retrieving the balance or claimable transactions through RPC. Thus, we rely on external services such as NeonDB, neoscan and notification servers for the information required.</p>
<p>However, do note that these APIs rely on hosted nodes by 3rd party and thus use them at your own risk.</p>
<p>This module is structured slightly different from the rest of the modules. While the rest of the modules are flat in terms of hierachy, this module is composed of largely many other submodules. Only the core methods are found at the top level of the module.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="core"></a><a href="#core" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Core</h2>
<p>These are core methods that help to tie up the different 3rd party APIs in order to simplify transaction creation and sending.</p>
<p>There are 3 core methods that covers majority of the functionality that is required:</p>
<ol>
<li><code>claimGas</code></li>
<li><code>sendAsset</code></li>
<li><code>doInvoke</code></li>
</ol>
<p>They operate by taking in a configuration object which contains all the information necessary to request, construct and send a transaction. At the end, the same configuration object is returned and you may inspect the <code>response</code> property to check for the success of your transaction.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> Neon.api.neoscan.instance(<span class="hljs-string">'TestNet'</span>)
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">api</span>: provider,
  <span class="hljs-attr">account</span>: <span class="hljs-keyword">new</span> Neon.wallet.Account(<span class="hljs-string">'MY_ADDRESS_PRIVATE_KEY'</span>)
}
Neon.api.claimGas(config)
.then(<span class="hljs-function">(<span class="hljs-params">conf</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(conf.response)
})

<span class="hljs-keyword">import</span> {api} <span class="hljs-keyword">from</span> <span class="hljs-string">'@cityofzion/neon-js'</span>
api.claimGas(config)
.then(<span class="hljs-function">(<span class="hljs-params">conf</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(conf.response)
})
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="building-blocks"></a><a href="#building-blocks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building blocks</h2>
<p>Under the hood, the core methods are actually a chain of functions strung together. These methods are also available in the package for your consumption if you have special needs outside of the 3 conventional methods.</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// This chain is basically api.claimGas</span>
api
  .getClaimsFrom(config, api.neonDB)
  .then(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> api.createTx(c, <span class="hljs-string">"claim"</span>))
  .then(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> api.signTx(c))
  .then(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> api.sendTx(c));
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="provider"></a><a href="#provider" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provider</h2>
<p>Providers are external services that provide information that is not easily gathered from the RPC nodes. For example, to send NEO or GAS, we need to retrieve all the UTXO information associated with an address.</p>
<p>The available providers are <code>neoscan</code>, <code>neonDB</code> and <code>notifications</code>. The first two are interfaces that translate the different REST responses into uniform data structures that are used by other <code>neon-js</code> modules, while the <code>notifications</code> interface handles subscriptions to a live feed of events being triggered inside a smart contract.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> mainNetNeoscan = <span class="hljs-keyword">new</span> api.neocan.instance(<span class="hljs-string">"MainNet"</span>);
<span class="hljs-keyword">const</span> mainNetNeonDB = <span class="hljs-keyword">new</span> api.neonDB.instance(<span class="hljs-string">"MainNet"</span>);
<span class="hljs-keyword">const</span> mainNetNotifications = <span class="hljs-keyword">new</span> api.notifications.instance(<span class="hljs-string">"MainNet"</span>);

<span class="hljs-keyword">const</span> neoscanBalance = <span class="hljs-keyword">await</span> mainNetNeoscan.getBalance(addr);
<span class="hljs-keyword">const</span> neonDBBalance = <span class="hljs-keyword">await</span> mainNetNeonDB.getBalance(addr);

<span class="hljs-built_in">console</span>.log(neoscanBalance.equals(neonDBBalance)); <span class="hljs-comment">// They should be the same datastructure with the same information</span>

<span class="hljs-keyword">const</span> subscription = mainNetNotifications.subscribe(<span class="hljs-string">"0x314b5aac1cdd01d10661b00886197f2194c3c89b"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.log(event); <span class="hljs-comment">// Print the events being received in real time</span>
});

subscription.unsubscribe(); <span class="hljs-comment">// Unsubscribe the previous subscription</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/neon-js/docs/en/api/core/logging.html"><span class="arrow-prev">← </span><span>Logging</span></a><a class="docs-next button" href="/neon-js/docs/en/api/plugin/nep5.html"><span>NEP5</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#core">Core</a></li><li><a href="#building-blocks">Building blocks</a></li><li><a href="#provider">Provider</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/neon-js/" class="nav-home"><img src="/neon-js/img/logo.svg" alt="neon-js" width="66" height="58"/></a><div><h5>Docs</h5><a href="/neon-js/docs/en/installation.html">Getting Started</a><a href="/neon-js/docs/en/guides/basic/sendasset.html">Guides</a><a href="/neon-js/docs/en/api/index.html">API Reference</a></div><div><h5>Community</h5><a href="https://discord.gg/wczVXTN">Discord Chat</a><a href="https://www.reddit.com/r/NEO/" target="_blank">NEO Reddit</a></div><div><h5>More</h5><a href="https://neo.org/" target="_blank">NEO</a><a href="https://github.com/cityofzion/neon-js" target="_blank">GitHub</a><a class="github-button" href="https://github.com/cityofzion/neon-js" data-icon="octicon-star" data-count-href="/cityofzion/neon-js/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="http://cityofzion.io" target="_blank" class="fbOpenSource"><img src="/neon-js/img/coz_med.png" alt="City of Zion" width="150" height="150"/></a><section class="copyright">Copyright © 2020 City of Zion</section></footer></div></body></html>